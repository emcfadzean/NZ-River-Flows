<html>

<head>
	<title>River Flow New Zealand</title>
	<style>
      #map {
        height: 100%;
      }
	  html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
    </style>
</head>

<body>

	<!--Creates Interactive Map with Rivers Marked-->
	<!---------------------------------------------->
	<div id="map">My map will go here</div>
	
	<script>
		//Define Map Properties
		function initMap() {
			var map = new google.maps.Map(document.getElementById('map'), {
				zoom: 6,
				center: {lat: -40.834541, lng: 173.473535}
			});
		setMarkers(map);
		}
		
		//Set River Marker Possitions - ADD RIVERS HERE!	
		var rivers = [
			["Upper Taieri", -45.649560, 170.276538, 1, "green"],
			["Lower Taieri", -45.792323, 170.309228, 2, "green"],
			["Leith", -45.864321, 170.514365, 3, "red"],
			["Tekapo Whitewater Course", -44.020199, 170.468593, 4, "green"]
		]
		
		//Add Interactive River Markers to Map
		function setMarkers(map){
			var image = {
				size: new google.maps.Size(20, 32),
				origin: new google.maps.Point(0, 0),
				anchor: new google.maps.Point(0, 32)
			};
			
			var shape = {
				coords: [1, 1, 1, 20, 18, 20, 18, 1],
				type: 'poly'
			};
			
			for(var i = 0; i < rivers.length; i++){
				var river = rivers[i];
				var marker  = new google.maps.Marker({	
					position: {lat: river[1], lng: river[2]},
					map: map,
					icon: image,
					shape: shape,
					title: river[0],
					zIndex: river[3]
				});
			}
		}
	</script>

	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBqC6_sJ4AVFbyXAfXBLc9dcBzHqvqPPTk&callback=initMap"></script>





	<!--Links to Otago Regional Council river flow data base. Fornat: JSON-->
	<!---------------------------------------------------------------------->
	<ul>
		<li><a id="link" href="#">Get flow info</a></li>
	</ul>
	<script>
		function appendZero(num){
			if(num<10){
				return "0" + num;
			}
			return num;
		}
		var d = new Date();
		var year = d.getFullYear();
		var month = d.getMonth() + 1;
		var day = d.getDate();
		var link = document.getElementById("link");
		link.setAttribute("href", "http://data.orc.govt.nz/v1/sql/TEL_RIVF/?$filter=Date eq datetime'" +year+ "-" +appendZero(month)+ "-" +appendZero(day)+ "T00:00:00'&format=json");
	</script>
	
</body>

</html>